#!/usr/bin/env python3

import sys
from visidata import Sheet, ColumnItem, asyncthread, options, run

class TsvSheet(Sheet):
    rowtype = 'rows'
    columns = [ColumnItem('tsv', 0)]

    @asyncthread
    def reload(self):
        self.rows = []

        with open(self.source, encoding=options.encoding) as fp:
            for line in fp:
                line = line[:-1]
                if line:
                    self.addRow(line.split('\t'))

        self.columns = [ColumnItem(colname, i) for i, colname in enumerate(self.rows[0])]
        self.rows = self.rows[1:]

run(*(TsvSheet(fn, source=fn) for fn in sys.argv[1:]))
